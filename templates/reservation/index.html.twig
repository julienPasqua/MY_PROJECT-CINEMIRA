{% extends 'base.html.twig' %}

{% block title %}Mes r√©servations{% endblock %}

{% block stylesheets %}
<style>
.page-title {
    font-size: 2.4rem;
    font-weight: 800;
    text-align: center;
    margin-bottom: 35px;
    color: #ffd700;
    text-shadow: 0 2px 10px rgba(0,0,0,0.4);
}

.resa-card {
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    border-radius: 18px;
    padding: 20px;
    color: #fff;
    display: flex;
    gap: 20px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.25);
    transition: transform 0.25s ease, box-shadow 0.25s ease;
    margin-bottom: 20px;
}

.resa-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 35px rgba(0,0,0,0.35);
}

.resa-poster {
    width: 110px;
    border-radius: 10px;
    object-fit: cover;
}

.resa-info-title {
    font-size: 1.4rem;
    font-weight: 800;
    color: #ffd700;
}

.resa-meta {
    opacity: 0.85;
    font-size: 0.95rem;
}

.resa-actions {
    margin-top: 12px;
}

.btn-details {
    background: #ffd700;
    color: #000;
    padding: 6px 14px;
    border-radius: 6px;
    text-decoration: none;
    font-weight: bold;
    transition: 0.2s;
}

.btn-details:hover {
    background: #e6be00;
}

.btn-cancel {
    background: #ff4545;
    color: white;
    padding: 6px 14px;
    border-radius: 6px;
    font-weight: bold;
    border: none;
    cursor: pointer;
    transition: 0.2s;
}

.btn-cancel:hover {
    background: #d63b3b;
}

.empty-message {
    text-align: center;
    font-size: 1.3rem;
    opacity: 0.85;
    margin-top: 40px;
}
</style>
{% endblock %}

{% block body %}

<h1 class="page-title">üéüÔ∏è Mes r√©servations</h1>

{% if reservations is empty %}
    <p class="empty-message">Vous n'avez encore aucune r√©servation.</p>
{% endif %}

{% for resa in reservations %}

    <div class="resa-card">

        {# Poster TMDB #}
        <img src="{{ resa.seance.film.posterUrl }}" class="resa-poster">

        <div style="flex: 1;">

            <div class="resa-info-title">
                {{ resa.seance.film.titre }}
            </div>

            <div class="resa-meta">
                üé¨ Cin√©ma : {{ resa.seance.salle.cinema.nom }} <br>
                üìÖ S√©ance : {{ resa.seance.dateSeance|date('d/m/Y') }}  
                ‚è∞ {{ resa.seance.heureDebut|date('H:i') }} <br>
                üí∫ Places : {{ resa.nombresPlaces }} <br>
                üí≤ Total : {{ resa.prixTotal }} ‚Ç¨
            </div>

            <div class="resa-actions">
                <a href="{{ path('app_reservation_show', { id: resa.id }) }}" class="btn-details">
                    üîç D√©tails
                </a>

                {% if resa.statut != 'annulee' %}
                <form method="post"
                      action="{{ path('app_reservation_cancel', { id: resa.id }) }}"
                      style="display:inline">
                    <input type="hidden" name="_token" value="{{ csrf_token('cancel_resa_' ~ resa.id) }}">
                    <button class="btn-cancel" onclick="return confirm('Annuler cette r√©servation ?')">
                        ‚ùå Annuler
                    </button>
                </form>
                {% endif %}
            </div>

        </div>
    </div>

{% endfor %}

{% endblock %}
